# Troubleshooting Netlify Blobs

Если на Netlify админка не сохраняет данные (ошибка "Failed to save"), выполните следующие шаги:

## Шаг 1: Проверка логов на Netlify

1. Зайдите в Netlify Dashboard
2. Выберите ваш сайт
3. Перейдите в **Functions** → **Logs**
4. Попробуйте сохранить услугу в админке
5. Посмотрите логи - там должны быть сообщения об ошибках

## Шаг 2: Проверка переменных окружения

Убедитесь, что в Netlify Dashboard → **Site settings** → **Environment variables** есть:
- `ADMIN_PASSWORD` (для входа в админку)

**Примечание:** Netlify Blobs не требуют специальных переменных окружения - они работают автоматически на Netlify.

## Шаг 3: Проверка версии @netlify/blobs

В `package.json` должна быть версия `@netlify/blobs@^10.3.2` или выше.

## Шаг 4: Альтернативное решение (если Blobs не работают)

Если Netlify Blobs не работают, можно использовать внешнюю базу данных:

### Вариант 1: Supabase (бесплатный)
- Создайте аккаунт на https://supabase.com
- Создайте проект и таблицы
- Используйте Supabase вместо файлов

### Вариант 2: MongoDB Atlas (бесплатный)
- Создайте аккаунт на https://www.mongodb.com/cloud/atlas
- Создайте кластер
- Используйте MongoDB вместо файлов

### Вариант 3: GitHub API (для сохранения в репозиторий)
- Используйте GitHub API для сохранения данных в JSON файлы в репозитории
- Требует GitHub Personal Access Token

## Шаг 5: Проверка консоли браузера

Откройте консоль браузера (F12) и посмотрите на ошибки при сохранении. Там может быть дополнительная информация.

## Шаг 6: Проверка сетевых запросов

В DevTools → Network посмотрите запрос к `/api/admin/services`:
- Какая ошибка возвращается?
- Какой статус код?
- Что в теле ответа?

## Текущая реализация

Проект использует Netlify Blobs для хранения данных на Netlify. Если Blobs не работают, код должен выбросить ошибку с подробным описанием проблемы.

### Что проверить в логах Netlify:

1. **Откройте Netlify Dashboard** → Ваш сайт → **Functions** → **Logs**
2. **Попробуйте сохранить услугу** в админке
3. **Ищите в логах:**
   - `Available Netlify Blobs methods:` - список доступных методов
   - `Store created successfully` - успешное создание store
   - `Failed to initialize Netlify Blobs:` - ошибка импорта пакета
   - `Error writing to Netlify Blobs:` - ошибка сохранения
   - `Netlify Blobs store not available` - store не создан

### Возможные проблемы и решения:

**Проблема 1:** `getStore not found in @netlify/blobs`
- **Решение:** Убедитесь, что пакет установлен: `npm install @netlify/blobs`
- Пересоберите проект на Netlify

**Проблема 2:** `Failed to create Blobs store`
- **Решение:** Это может быть проблема с правами доступа. Проверьте, что проект правильно деплоится на Netlify

**Проблема 3:** `Error writing to Netlify Blobs: ...`
- **Решение:** Проверьте полный текст ошибки в логах. Возможные причины:
  - Неправильная конфигурация Blobs
  - Проблемы с сетью
  - Ограничения Netlify плана

## Если проблема сохраняется

1. ✅ Проверьте логи Netlify Functions (как описано выше)
2. ✅ Убедитесь, что пакет `@netlify/blobs@^10.3.2` установлен
3. ✅ Попробуйте пересобрать проект на Netlify (Deploys → Trigger deploy)
4. ✅ Проверьте, что используете правильную версию Node.js (20)
5. ✅ Проверьте консоль браузера (F12) на наличие ошибок
6. ✅ Проверьте Network tab в DevTools - какой ответ приходит от `/api/admin/services`

## Контактная информация

Если проблема не решается, соберите следующую информацию:
- Логи из Netlify Functions
- Скриншот ошибки из консоли браузера
- Версию Node.js из `netlify.toml`
- Версию `@netlify/blobs` из `package.json`

